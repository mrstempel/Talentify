@using System.Globalization
@model Talentify.ORM.DAL.Models.Content.Event

@{
    ViewBag.Title = "Register";
    Layout = "~/Views/Shared/_LayoutModal.cshtml";
}

<article>
	<div class="msg-container" id="msg-container">
		<div id="msg-error" class="msg error"><h2>Fehler bei Anmeldung</h2><p>Ein unerwateter Fehler ist aufgetreten. Bitte versuche es erneut.</p></div>
		<div id="msg-success" class="msg success"><h2>Anmeldung erfolgreich.</h2><p>Du bist jetzt für das Event @Html.Raw(Model.Headline) angemeldet.</p></div>
	</div>
	@if (FormSuccess == null)
	{
		using (Html.BeginForm("Register", "Events", FormMethod.Post, new {@class = "form-container"}))
		{
			@Html.HiddenFor(m => m.Id)
			<input type="hidden" name="doRegister" value="true"/>
			<div class="field-container">
				<h3>@Html.Raw(Model.Headline)</h3>
				<p>@Model.LocationName<br/>@Model.Address, @Model.ZipCode @Model.City @Model.Country</p>
				<p class="important">@Model.BeginDate.ToString("dddd, d.M.yyyy", new CultureInfo("de"))<br/>von @Model.BeginTime bis @Model.EndTime</p>
			</div>
			<div class="field-container">
				<input type="submit" value="Anmelden" onclick="$(this).addClass('disabled');"/>
			</div>
		}
	}
	else
	{
		<script>
			window.parent.loadEventOpenSeats(@Model.Id);
			window.parent.disableRegistration();
			setTimeout(function () { window.parent.hideModal('modal-event-register'); }, 3000);
		</script>
	}
</article>
